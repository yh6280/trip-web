import{A as J,B as _,U as A,V as K,C as L,ar as $,D as j,r as x,q as O,as as Q,$ as W,k as f,a9 as Z,J as B,a1 as F,ap as ee,K as te}from"./index-ec12e08f.js";import{u as ae}from"./index-4f4eded0.js";import{a as oe}from"./index-769920f1.js";const[le,h]=J("rate");function se(t,s,i,r){return t>=s?{status:"full",value:1}:t+.5>=s&&i&&!r?{status:"half",value:.5}:t+1>=s&&i&&r?{status:"half",value:Math.round((t-s+1)*1e10)/1e10}:{status:"void",value:0}}const ie={size:_,icon:A("star"),color:String,count:K(5),gutter:_,readonly:Boolean,disabled:Boolean,voidIcon:A("star-o"),allowHalf:Boolean,voidColor:String,touchable:L,iconPrefix:String,modelValue:$(0),disabledColor:String};var ne=j({name:le,props:ie,emits:["change","update:modelValue"],setup(t,{emit:s}){const i=oe(),[r,P]=ae(),m=x(),p=()=>t.readonly||t.disabled||!t.touchable,X=O(()=>Array(+t.count).fill("").map((a,e)=>se(t.modelValue,e+1,t.allowHalf,t.readonly)));let l,u,g=Number.MAX_SAFE_INTEGER,b=Number.MIN_SAFE_INTEGER;const S=()=>{u=F(m);const a=r.value.map(F);l=[],a.forEach((e,o)=>{g=Math.min(e.top,g),b=Math.max(e.top,b),t.allowHalf?l.push({score:o+.5,left:e.left,top:e.top,height:e.height},{score:o+1,left:e.left+e.width/2,top:e.top,height:e.height}):l.push({score:o+1,left:e.left,top:e.top,height:e.height})})},V=(a,e)=>{for(let o=l.length-1;o>0;o--)if(e>=u.top&&e<=u.bottom){if(a>l[o].left&&e>=l[o].top&&e<=l[o].top+l[o].height)return l[o].score}else{const c=e<u.top?g:b;if(a>l[o].left&&l[o].top===c)return l[o].score}return t.allowHalf?.5:1},y=a=>{!t.disabled&&!t.readonly&&a!==t.modelValue&&(s("update:modelValue",a),s("change",a))},D=a=>{p()||(i.start(a),S())},G=a=>{if(!p()&&(i.move(a),i.isHorizontal())){const{clientX:e,clientY:o}=a.touches[0];ee(a),y(V(e,o))}},U=(a,e)=>{const{icon:o,size:c,color:C,count:I,gutter:N,voidIcon:T,disabled:n,voidColor:k,allowHalf:E,iconPrefix:w,disabledColor:z}=t,v=e+1,R=a.status==="full",d=a.status==="void",Y=E&&a.value>0&&a.value<1;let H;N&&v!==+I&&(H={paddingRight:Z(N)});const q=M=>{S(),y(E?V(M.clientX,M.clientY):v)};return f("div",{key:e,ref:P(e),role:"radio",style:H,class:h("item"),tabindex:n?void 0:0,"aria-setsize":I,"aria-posinset":v,"aria-checked":!d,onClick:q},[f(B,{size:c,name:R?o:T,class:h("icon",{disabled:n,full:R}),color:n?z:R?C:k,classPrefix:w},null),Y&&f(B,{size:c,style:{width:a.value+"em"},name:d?T:o,class:h("icon",["half",{disabled:n,full:!d}]),color:n?z:d?k:C,classPrefix:w},null)])};return Q(()=>t.modelValue),W("touchmove",G,{target:m}),()=>f("div",{ref:m,role:"radiogroup",class:h({readonly:t.readonly,disabled:t.disabled}),tabindex:t.disabled?void 0:0,"aria-disabled":t.disabled,"aria-readonly":t.readonly,onTouchstartPassive:D},[X.value.map(U)])}});const de=te(ne);export{de as R};
