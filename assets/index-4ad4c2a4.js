import{A as Y,U as E,B as A,C as ie,ai as j,L as W,ah as Le,D as G,az as Te,k as o,a2 as I,J as N,K as X,ax as Pe,ab as Re,aA as Me,aB as Ae,aC as Be,V as _e,X as De,r as q,aj as $e,aD as Ne,q as D,a9 as Oe,al as Fe,Z as ze,a7 as z,o as je,$ as qe,aE as ne,aF as We,ap as J,aG as Ke,ad as oe,at as He,aH as Ue,ae}from"./index-ec12e08f.js";import{u as ce}from"./use-id-c4d8d257.js";import{u as se}from"./index-769920f1.js";const[Je,M]=Y("cell"),ue={tag:E("div"),icon:String,size:String,title:A,value:A,label:A,center:Boolean,isLink:Boolean,border:ie,required:Boolean,iconPrefix:String,valueClass:j,labelClass:j,titleClass:j,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},Ye=W({},ue,Le);var Ge=G({name:Je,props:Ye,setup(e,{slots:n}){const a=Te(),f=()=>{if(n.label||I(e.label))return o("div",{class:[M("label"),e.labelClass]},[n.label?n.label():e.label])},r=()=>{var c;if(n.title||I(e.title)){const h=(c=n.title)==null?void 0:c.call(n);return Array.isArray(h)&&h.length===0?void 0:o("div",{class:[M("title"),e.titleClass],style:e.titleStyle},[h||o("span",null,[e.title]),f()])}},u=()=>{const c=n.value||n.default;if(c||I(e.value))return o("div",{class:[M("value"),e.valueClass]},[c?c():o("span",null,[e.value])])},L=()=>{if(n.icon)return n.icon();if(e.icon)return o(N,{name:e.icon,class:M("left-icon"),classPrefix:e.iconPrefix},null)},V=()=>{if(n["right-icon"])return n["right-icon"]();if(e.isLink){const c=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return o(N,{name:c,class:M("right-icon")},null)}};return()=>{var c;const{tag:h,size:m,center:B,border:T,isLink:_,required:k}=e,S=(c=e.clickable)!=null?c:_,w={center:B,required:k,clickable:S,borderless:!T};return m&&(w[m]=!!m),o(h,{class:M(w),role:S?"button":void 0,tabindex:S?0:void 0,onClick:a},{default:()=>{var x;return[L(),r(),u(),V(),(x=n.extra)==null?void 0:x.call(n)]}})}}});const Xe=X(Ge);function de(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Ze(e,n){if(de(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Qe(e,n){return new Promise(a=>{const f=n.validator(e,n);if(Ae(f)){f.then(a);return}a(f)})}function le(e,n){const{message:a}=n;return Be(a)?a(e,n):a||""}function pe({target:e}){e.composing=!0}function re({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function et(e,n){const a=Pe();e.style.height="auto";let f=e.scrollHeight;if(Me(n)){const{maxHeight:r,minHeight:u}=n;r!==void 0&&(f=Math.min(f,r)),u!==void 0&&(f=Math.max(f,u))}f&&(e.style.height=`${f}px`,Re(a))}function tt(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function C(e){return[...e].length}function U(e,n){return[...e].slice(0,n).join("")}const[nt,v]=Y("field"),Z={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:A,formatter:Function,clearIcon:E("clear"),modelValue:_e(""),inputAlign:String,placeholder:String,autocomplete:String,errorMessage:String,enterkeyhint:String,clearTrigger:E("focus"),formatTrigger:E("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},at=W({},ue,Z,{rows:A,type:E("text"),rules:Array,autosize:[Boolean,Object],labelWidth:A,labelClass:j,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var lt=G({name:nt,props:at,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a}){const f=ce(),r=De({status:"unvalidated",focused:!1,validateMessage:""}),u=q(),L=q(),V=q(),{parent:c}=$e(Ne),h=()=>{var t;return String((t=e.modelValue)!=null?t:"")},m=t=>{if(I(e[t]))return e[t];if(c&&I(c.props[t]))return c.props[t]},B=D(()=>{const t=m("readonly");if(e.clearable&&!t){const s=h()!=="",i=e.clearTrigger==="always"||e.clearTrigger==="focus"&&r.focused;return s&&i}return!1}),T=D(()=>V.value&&a.input?V.value():e.modelValue),_=t=>t.reduce((s,i)=>s.then(()=>{if(r.status==="failed")return;let{value:d}=T;if(i.formatter&&(d=i.formatter(d,i)),!Ze(d,i)){r.status="failed",r.validateMessage=le(d,i);return}if(i.validator)return de(d)&&i.validateEmpty===!1?void 0:Qe(d,i).then(g=>{g&&typeof g=="string"?(r.status="failed",r.validateMessage=g):g===!1&&(r.status="failed",r.validateMessage=le(d,i))})}),Promise.resolve()),k=()=>{r.status="unvalidated",r.validateMessage=""},S=()=>n("endValidate",{status:r.status,message:r.validateMessage}),w=(t=e.rules)=>new Promise(s=>{k(),t?(n("startValidate"),_(t).then(()=>{r.status==="failed"?(s({name:e.name,message:r.validateMessage}),S()):(r.status="passed",s(),S())})):s()}),x=t=>{if(c&&e.rules){const{validateTrigger:s}=c.props,i=ne(s).includes(t),d=e.rules.filter(g=>g.trigger?ne(g.trigger).includes(t):i);d.length&&w(d)}},K=t=>{var s;const{maxlength:i}=e;if(I(i)&&C(t)>i){const d=h();if(d&&C(d)===+i)return d;const g=(s=u.value)==null?void 0:s.selectionEnd;if(r.focused&&g){const b=[...t],y=b.length-+i;return b.splice(g-y,y),b.join("")}return U(t,+i)}return t},P=(t,s="onChange")=>{const i=t;t=K(t);const d=C(i)-C(t);if(e.type==="number"||e.type==="digit"){const b=e.type==="number";t=We(t,b,b)}let g=0;if(e.formatter&&s===e.formatTrigger){const{formatter:b,maxlength:y}=e;if(t=b(t),I(y)&&C(t)>y&&(t=U(t,+y)),u.value&&r.focused){const{selectionEnd:F}=u.value,te=U(i,F);g=C(b(te))-C(te)}}if(u.value&&u.value.value!==t)if(r.focused){let{selectionStart:b,selectionEnd:y}=u.value;if(u.value.value=t,I(b)&&I(y)){const F=C(t);d?(b-=d,y-=d):g&&(b+=g,y+=g),u.value.setSelectionRange(Math.min(b,F),Math.min(y,F))}}else u.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},H=t=>{t.target.composing||P(t.target.value)},l=()=>{var t;return(t=u.value)==null?void 0:t.blur()},O=()=>{var t;return(t=u.value)==null?void 0:t.focus()},R=()=>{const t=u.value;e.type==="textarea"&&e.autosize&&t&&et(t,e.autosize)},fe=t=>{r.focused=!0,n("focus",t),z(R),m("readonly")&&l()},ge=t=>{m("readonly")||(r.focused=!1,P(h(),"onBlur"),n("blur",t),x("onBlur"),z(R),Ue())},Q=t=>n("clickInput",t),me=t=>n("clickLeftIcon",t),he=t=>n("clickRightIcon",t),be=t=>{J(t),n("update:modelValue",""),n("clear",t)},p=D(()=>{if(typeof e.error=="boolean")return e.error;if(c&&c.props.showError&&r.status==="failed")return!0}),ve=D(()=>{const t=m("labelWidth");if(t)return{width:Oe(t)}}),ye=t=>{t.keyCode===13&&(!(c&&c.props.submitOnEnter)&&e.type!=="textarea"&&J(t),e.type==="search"&&l()),n("keypress",t)},ee=()=>e.id||`${f}-input`,Ce=()=>r.status,Ie=()=>{const t=v("control",[m("inputAlign"),{error:p.value,custom:!!a.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(a.input)return o("div",{class:t,onClick:Q},[a.input()]);const s={id:ee(),ref:u,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:m("disabled"),readonly:m("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,enterkeyhint:e.enterkeyhint,"aria-labelledby":e.label?`${f}-label`:void 0,onBlur:ge,onFocus:fe,onInput:H,onClick:Q,onChange:re,onKeypress:ye,onCompositionend:re,onCompositionstart:pe};return e.type==="textarea"?o("textarea",s,null):o("input",oe(tt(e.type),s),null)},ke=()=>{const t=a["left-icon"];if(e.leftIcon||t)return o("div",{class:v("left-icon"),onClick:me},[t?t():o(N,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},Se=()=>{const t=a["right-icon"];if(e.rightIcon||t)return o("div",{class:v("right-icon"),onClick:he},[t?t():o(N,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},xe=()=>{if(e.showWordLimit&&e.maxlength){const t=C(h());return o("div",{class:v("word-limit")},[o("span",{class:v("word-num")},[t]),He("/"),e.maxlength])}},Ve=()=>{if(c&&c.props.showErrorMessage===!1)return;const t=e.errorMessage||r.validateMessage;if(t){const s=a["error-message"],i=m("errorMessageAlign");return o("div",{class:v("error-message",i)},[s?s({message:t}):t])}},we=()=>{const t=m("colon")?":":"";if(a.label)return[a.label(),t];if(e.label)return o("label",{id:`${f}-label`,for:ee()},[e.label+t])},Ee=()=>[o("div",{class:v("body")},[Ie(),B.value&&o(N,{ref:L,name:e.clearIcon,class:v("clear")},null),Se(),a.button&&o("div",{class:v("button")},[a.button()])]),xe(),Ve()];return se({blur:l,focus:O,validate:w,formValue:T,resetValidation:k,getValidationStatus:Ce}),Fe(Ke,{customValue:V,resetValidation:k,validateWithTrigger:x}),ze(()=>e.modelValue,()=>{P(h()),k(),x("onChange"),z(R)}),je(()=>{P(h(),e.formatTrigger),z(R)}),qe("touchstart",be,{target:D(()=>{var t;return(t=L.value)==null?void 0:t.$el})}),()=>{const t=m("disabled"),s=m("labelAlign"),i=ke(),d=()=>{const g=we();return s==="top"?[i,g].filter(Boolean):g||[]};return o(Xe,{size:e.size,class:v({error:p.value,disabled:t,[`label-${s}`]:s}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:ve.value,valueClass:v("value"),titleClass:[v("label",[s,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:i&&s!=="top"?()=>i:null,title:d,value:Ee,extra:a.extra})}}});const rt=X(lt),[it,$,ot]=Y("search"),ct=W({},Z,{label:String,shape:E("square"),leftIcon:E("search"),clearable:ie,actionText:String,background:String,showAction:Boolean});var st=G({name:it,props:ct,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:a,attrs:f}){const r=ce(),u=q(),L=()=>{a.action||(n("update:modelValue",""),n("cancel"))},V=l=>{l.keyCode===13&&(J(l),n("search",e.modelValue))},c=()=>e.id||`${r}-input`,h=()=>{if(a.label||e.label)return o("label",{class:$("label"),for:c()},[a.label?a.label():e.label])},m=()=>{if(e.showAction){const l=e.actionText||ot("cancel");return o("div",{class:$("action"),role:"button",tabindex:0,onClick:L},[a.action?a.action():l])}},B=()=>{var l;return(l=u.value)==null?void 0:l.blur()},T=()=>{var l;return(l=u.value)==null?void 0:l.focus()},_=l=>n("blur",l),k=l=>n("focus",l),S=l=>n("clear",l),w=l=>n("clickInput",l),x=l=>n("clickLeftIcon",l),K=l=>n("clickRightIcon",l),P=Object.keys(Z),H=()=>{const l=W({},f,ae(e,P),{id:c()}),O=R=>n("update:modelValue",R);return o(rt,oe({ref:u,type:"search",class:$("field"),border:!1,onBlur:_,onFocus:k,onClear:S,onKeypress:V,onClickInput:w,onClickLeftIcon:x,onClickRightIcon:K,"onUpdate:modelValue":O},l),ae(a,["left-icon","right-icon"]))};return se({focus:T,blur:B}),()=>{var l;return o("div",{class:$({"show-action":e.showAction}),style:{background:e.background}},[(l=a.left)==null?void 0:l.call(a),o("div",{class:$("content",e.shape)},[h(),H()]),m()])}}});const gt=X(st);export{Xe as C,gt as S};
